$(function(){function w(){e=b.width()>767?!1:!0}function E(){container=t.get(0),r=new THREE.PerspectiveCamera(75,f/l,1,5e3),r.position.z=1e3,i=new THREE.Scene;var e=function(t,n,r){for(var s=0;s<t;s++){o=new THREE.Particle(new THREE.ParticleBasicMaterial({map:new THREE.Texture(x(n)),blending:THREE.AdditiveBlending}));var u=r*(Math.random()*2+1),a=r*Math.random();T(o,a,u,n),i.add(o)}};e(d,p,1e4),e(m,v,5e3),s=new THREE.CanvasRenderer,s.setSize(f,l),s.sortElements=!1,s.setClearColorHex(2539973,1),container.appendChild(s.domElement),y&&(n=new Stats,n.domElement.style.position="absolute",n.domElement.style.top="0px",container.appendChild(n.domElement)),w(),document.addEventListener("mousemove",N,!1),window.addEventListener("resize",S,!1)}function S(){f=window.innerWidth,c=f/2,h=l/2,r.aspect=f/l,r.updateProjectionMatrix(),s.setSize(f,l)}function x(e){var t=Math.random(),n=document.createElement("canvas"),r=t*e+g,i=n.width=r,s=n.height=r,o=r/2,u=o,a=n.getContext("2d"),f=a.createRadialGradient(u,o,0,u,o,u),l=function(){return parseInt(Math.random()*255,10)},c=function(e){var n=parseInt((1-t)*(1-t)*70,10);return""+l()+",100%,"+n+"%"},h=function(e,t){return"hsla("+e+","+t+")"},p=c(r);return f.addColorStop(0,h(p,1)),f.addColorStop(.2,h(p,.5)),f.addColorStop(.4,h(p,.2)),f.addColorStop(1,h(p,0)),a.fillStyle=f,a.fillRect(0,0,i,s),n}function T(e,t,n,r){var e=this instanceof THREE.Particle?this:e,t=t!==undefined?t:0,i=n,s=r>10?20:1;e.position.x=(Math.random()*f-c)*3,e.position.y=(Math.random()*l-h)*3,e.position.z=0,e.material.opacity=0,e.scale.x=e.scale.y=s;var o=n*(r>10?4:3);(new TWEEN.Tween(e.position)).delay(t).to({x:Math.random()*f*2-f,y:Math.random()*l*2-l,z:Math.random()*4e3-2e3},o).start();var u=(new TWEEN.Tween(e.material)).delay(t).to({opacity:.6},i),a=(new TWEEN.Tween(e.material)).to({opacity:.01},n).onComplete(function(){T(e,t,n,r)});return u.chain(a),u.start(),e}function N(e){u=e.clientX-c,a=e.clientY-h}function C(e){e.touches.length==1&&(e.preventDefault(),u=e.touches[0].pageX-c,a=e.touches[0].pageY-h)}function k(e){e.touches.length==1&&(e.preventDefault(),u=e.touches[0].pageX-c,a=e.touches[0].pageY-h)}function L(){setTimeout(function(){requestAnimationFrame(L)},40),e||A(),y&&n.update()}function A(){TWEEN.update(),r.position.x+=(u/3-r.position.x)*.01,r.position.y+=(-a/3-r.position.y)*.01,r.lookAt(i.position),s.render(i,r)}var e=!0,t=$("#particles"),n,r,i,s,o,u=0,a=0,f=window.innerWidth,l=t.height(),c=f/2,h=l/2,p=100,d=20,v=1,m=50,g=32,y=!1,b=$(window);E(),L(),$(function(){w()})});